/*
DROP TABLE "MEMBER" CASCADE CONSTRAINTS;
DROP TABLE "SCHEDULE" CASCADE CONSTRAINTS;
DROP TABLE "TICKET" CASCADE CONSTRAINTS;
DROP TABLE "NOTICE" CASCADE CONSTRAINTS;
DROP TABLE "FAQ" CASCADE CONSTRAINTS;
DROP TABLE "INQUIRY" CASCADE CONSTRAINTS;
DROP TABLE "ANSWER" CASCADE CONSTRAINTS;
DROP TABLE "NOTICE_ATTACH" CASCADE CONSTRAINTS; 

DROP SEQUENCE "SEQ_ANSWER_ANO";
DROP SEQUENCE "SEQ_FAQ_FNO";
DROP SEQUENCE "SEQ_INQUIRY_INO";
DROP SEQUENCE "SEQ_NOTICE_NNO";
DROP SEQUENCE "SEQ_SCHEDULE_SNUM";
DROP SEQUENCE "SEQ_TICKET_MNUM";
DROP SEQUENCE "SEQ_TICKET_RNO_O";
DROP SEQUENCE "SEQ_TICKET_RNO_R";
*/

CREATE TABLE MEMBER(
    ID VARCHAR2 (30),
    PASS VARCHAR2 (30),
    NAME VARCHAR2 (15),
    BIRTH DATE,
    TEL VARCHAR2 (13),
    GENDER VARCHAR2 (1),
    AUTH VARCHAR2 (10)
);

ALTER TABLE MEMBER ADD CONSTRAINT PK_MEMBER PRIMARY KEY(ID);

ALTER TABLE MEMBER MODIFY BIRTH TIMESTAMP DEFAULT CURRENT_TIMESTAMP;

INSERT INTO MEMBER VALUES ('GILDONG','ABC123','홍길동','19990909','010-1999-1999','M','ADMIN');

INSERT INTO MEMBER VALUES ('USER1','AAA1','유저1','20010101','010-0001-0001','M','USER');

INSERT INTO MEMBER VALUES ('USER2','AAA2','유저2','20020202','010-0002-0002','F','USER');

INSERT INTO MEMBER VALUES ('USER3','AAA3','유저3','20030303','010-0003-0003','M','USER');

INSERT INTO MEMBER VALUES ('USER4','AAA4','유저4','20040404','010-0004-0004','F','USER');

INSERT INTO MEMBER VALUES ('USER5','AAA5','유저5','20050505','010-0005-0005','M','USER');

CREATE TABLE SCHEDULE(    
    SNUM NUMBER NOT NULL, --스케줄번호
    GRADE VARCHAR2(6) NOT NULL,           --등급
    DEPARTURE VARCHAR2 (20) NOT NULL, --출발지
    ARRIVAL VARCHAR2 (20) NOT NULL,   --도착지
    WORKDAY VARCHAR2(12) NOT NULL, --운영요일
    ST VARCHAR2 (5) NOT NULL,             --출발시간
    ETA NUMBER NOT NULL,              --소요시간
    PRICE NUMBER NOT NULL             --요금표
);

ALTER TABLE SCHEDULE ADD CONSTRAINT PK_SCHEDULE PRIMARY KEY(SNUM);

CREATE SEQUENCE SEQ_SCHEDULE_SNUM;

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','동서울','부산','평일','09:10',400,48000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','동서울','부산','평일','15:10',405,48000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','강릉','전주','평일','07:00',290,37000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','동서울','동대구','평일','07:00',300,38000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','포항','김포공항','평일','17:00',210,31000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','부산','동서울','평일','20:00',410,48000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','울산','익산','주말','12:05',245,34000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','부천','수원','주말','06:40',90,18000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','수원','부천','주말','23:40',90,18000);

INSERT INTO SCHEDULE VALUES (SEQ_SCHEDULE_SNUM.NEXTVAL,'우등','김포공항','포항','상시','11:40',218,31000);



CREATE TABLE TICKET(
    MNUM NUMBER NOT NULL,   --관리번호
    SNUM NUMBER NOT NULL,               --스케줄번호
    RNO VARCHAR2(30) NOT NULL,          --예매번호
    TDATE DATE DEFAULT SYSDATE NOT NULL,   --예매일
    DDATE DATE NOT NULL,                --출발일
    ID VARCHAR2 (30) NOT NULL,          --아이디
    SEATNUM VARCHAR2 (15) NOT NULL,     --좌석번호
    ptype VARCHAR2 (2) not null,	--탑승객유형
    PET VARCHAR2 (2),                    --반려동물
    CONSTRAINT FK_TICKET_SNUM FOREIGN KEY(SNUM) REFERENCES SCHEDULE(SNUM) ON DELETE CASCADE,
    CONSTRAINT FK_TICKET_ID FOREIGN KEY(ID) REFERENCES MEMBER(ID) ON DELETE CASCADE
);

ALTER TABLE TICKET ADD CONSTRAINT PK_TICKET PRIMARY KEY(MNUM);


CREATE SEQUENCE SEQ_TICKET_MNUM;
CREATE SEQUENCE SEQ_TICKET_RNO_O;
CREATE SEQUENCE SEQ_TICKET_RNO_R;

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 4, 'O'||SEQ_TICKET_RNO_O.NEXTVAL, sysdate, TO_DATE('20231216070000','YYYYMMDDHH24MISS'), 'USER1','A01','A','N');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 5, 'R'||SEQ_TICKET_RNO_R.NEXTVAL, sysdate, TO_DATE('20231221170000','YYYYMMDDHH24MISS'),'USER2','A14','A','Y');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 10, 'R'||SEQ_TICKET_RNO_R.CURRVAL, sysdate, TO_DATE('20231225114000','YYYYMMDDHH24MISS'),'USER2','A18','T','N');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 7, 'O'||SEQ_TICKET_RNO_O.NEXTVAL, sysdate, TO_DATE('20231224120500','YYYYMMDDHH24MISS'),'USER3','B03','T','N');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 2, 'R'||SEQ_TICKET_RNO_R.NEXTVAL, sysdate, TO_DATE('20231220151000','YYYYMMDDHH24MISS'),'USER1','B03','K','N');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 6, 'R'||SEQ_TICKET_RNO_R.CURRVAL, sysdate, TO_DATE('20231218200000','YYYYMMDDHH24MISS'),'USER1','B03','K','N');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 9, 'O'||SEQ_TICKET_RNO_O.NEXTVAL, sysdate, TO_DATE('20231217234000','YYYYMMDDHH24MISS'),'USER4','A17','A','Y');

INSERT INTO TICKET VALUES (SEQ_TICKET_MNUM.NEXTVAL, 10, 'O'||SEQ_TICKET_RNO_O.NEXTVAL, sysdate, TO_DATE('20231225114000','YYYYMMDDHH24MISS'),'USER5','B01','A','Y');




CREATE TABLE NOTICE(
    NNO NUMBER NOT NULL,    --게시물 번호
    WRITER VARCHAR2 (30) NOT NULL,      --작성자
    TITLE VARCHAR2 (100) NOT NULL,      --제목
    CONTENT VARCHAR2 (4000) NOT NULL,   --내용
    top VARCHAR2(2) default 'n' not null,	--중요(Y/N)
    REGDATE DATE DEFAULT SYSDATE,       --작성일자
    CONSTRAINT FK_NOTICE_WRITER FOREIGN KEY(WRITER) REFERENCES MEMBER(ID) ON DELETE CASCADE
);

ALTER TABLE NOTICE ADD CONSTRAINT PK_NOTICE PRIMARY KEY(NNO);

CREATE SEQUENCE SEQ_NOTICE_NNO;

INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','내년부터 몇개의 버스가 운행이 중단합니다.','착오 없으시길 바랍니다.','n',SYSDATE);

INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','전좌석 와이파이 사용방법','와이파이ID:skt010101 접속 후 비밀번호 1234 입력하세요','y',TO_DATE('20231201010101','YYYYMMDDHH24MISS'));

INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','개인정보 처리방침 약관 개정 안내','고속버스 개인정보 처리방침 관련하여 수집하는 개인정보 항목이 변경되어 개정사항 사전 안내 드립니다.','n',SYSDATE);


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','고객센터 점심시간 운영 안내','고객센터 점심시간 운영 안내 점심시간 : 12시~13시 상담 제한 안내 점심시간에는 ARS 안내, 문자서비스, 장애 상담만 가능합니다. 일반 상담 업무는 제한되며, 13시 이후부터 모든 상담이 가능합니다.','y',TO_DATE('20231203010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','고속버스 음식물 반입 자제 안내','고속버스 승차시 과도한 냄새가 나는 음식물 반입을 자제하시어 차량내 쾌적한 환경을 유지할 수 있도록 협조하여 주시기 바랍니다.','n',TO_DATE('20231202010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','홈페이지 오픈','<고속버스통합예매 홈페이지 오픈 안내> 고속버스 예매! 새롭게 시작합니다! ','n',TO_DATE('20231201010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','고속버스 이용자 만족도 조사','본 설문조사는 대중교통 이용자분들을 대상으로 고객만족도를 파악하여 대중교통의 서비스 개선 및 안전성 확보를 유도하기 위해 시행하고 있습니다.','n',TO_DATE('20231210010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','전자금융거래 이용자 유의 사항','보다 안전한 전자금융거래를 위한 방법을 안내해 드립니다.','n',TO_DATE('20231211010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','2024년 설 명절 특별수송','2024년 설 명절 예매 및 특별수송 기간 중 승차 홈 변경 안내를 알려드립니다. 

1. 2020년 추석 교통 특별대책기간
 - 2020년 9월 29 (화) ~ 10월 4일 (일)
 N

2. 2020년 추석 명절 특별수송 예매일정
 - 일자 : 2020년 8월 24 (월) 10시부터
 - 대상 : 고속버스 전 노선

3. 서울경부 터미널 승차 홈 변경
 - 기간 : 2020년 9월 29일 (화) ~ 10월 4일 (일) / 6일간

','n',TO_DATE('20240102010101','YYYYMMDDHH24MISS'));




INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','예매안내','홈페이지를 통한 예매는 당일 출발하는 차량의 출발시간 한 시간 이전까지 예매 가능합니다.','n',TO_DATE('20231201010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','승차권 환불안내','고속버스 승차권 환불 규정에 대한 안내입니다. 
승차권 환불 규정
＊승차권을 환불하신 후(승객용) 승차권을 교부 받으시면 정상적으로 환불 처리가 되었음을 의미하며 안심하셔도 됩니다.
＊고속조합에서는 고객의 개별적인 승인취소 요청에 대해 처리해드리지 않사오니 양해 부탁드립니다.
＊계좌이체 예매취소 시 즉시 예매 당시의 출금계좌로 입금되나 장애 발생 시 최대 1시간까지 입금이 지연될 수도 있습니다.
','n',TO_DATE('20231201010101','YYYYMMDDHH24MISS'));



INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','반려동물 탑승안내','반려동물 동반탑승시 안내사항입니다.','n',TO_DATE('20231204010101','YYYYMMDDHH24MISS'));


INSERT INTO NOTICE VALUES (SEQ_NOTICE_NNO.NEXTVAL,'GILDONG','화정터미널 폐업 안내','폐업예정일자 2023년 5월 31일 : ','n',TO_DATE('2023120210101','YYYYMMDDHH24MISS'));





CREATE TABLE FAQ(
    FNO NUMBER NOT NULL,    --게시물 번호
    WRITER VARCHAR2(30) NOT NULL,       --작성자
    QUESTION VARCHAR2(1000) NOT NULL,   --질문
    ANSWER VARCHAR2(4000) NOT NULL,     --답변
    CATEGORY VARCHAR2(100) NOT NULL,	--카테고리
    REGDATE DATE DEFAULT SYSDATE,       --작성일자
    CONSTRAINT FK_FAQ_WRITER FOREIGN KEY(WRITER) REFERENCES MEMBER(ID) ON DELETE CASCADE
);

ALTER TABLE FAQ ADD CONSTRAINT PK_FAQ PRIMARY KEY(FNO);

CREATE SEQUENCE SEQ_FAQ_FNO;

INSERT INTO FAQ VALUES (SEQ_FAQ_FNO.NEXTVAL,'GILDONG','제가 시간을 착각해서 1분차이로 버스를 놓쳤어요. 혹시 이경우 어느정도 결제금액에 대한 환급을 받을수 있을까요?','죄송하지만 지각 건에 대해서는 100% 고객님의 과실이기때문에 환불처리가 어려움을 말씀드립니다. 도움을 드리지 못하여 죄송합니다.','결제/환불',SYSDATE);

INSERT INTO FAQ VALUES (SEQ_FAQ_FNO.NEXTVAL,'GILDONG','제가 너무 바빠서 간단한 끼니를 버스안에서 급하게 때워야 할거같은데 최대한 냄새 안나는걸로 취식 가능할까요?','규정상 냄새가 발생하는 따뜻한 음식은 취식이 불가합니다.다만,(플라스틱 용기의) 액체류 및 과일류는 음용/취식 가능합니다.','기타',TO_DATE('20231201010101','YYYYMMDDHH24MISS'));

INSERT INTO FAQ VALUES (SEQ_FAQ_FNO.NEXTVAL,'USER1','시외버스 예매를 하고 싶어요.','시외버스 예매는 홈페이지 또는 모바일앱에서 가능합니다.','예매',SYSDATE);




CREATE TABLE INQUIRY(
    INO NUMBER NOT NULL,    --게시물 번호
    WRITER VARCHAR2 (30) NOT NULL,      --작성자
    TITLE VARCHAR2 (100) NOT NULL,      --제목
    CONTENT VARCHAR2 (4000) NOT NULL,   --내용
    CATEGORY VARCHAR2(100) NOT NULL,    --분류
    REGDATE DATE DEFAULT SYSDATE,       --작성일자
    CONSTRAINT FK_INQUIRY_WRITER FOREIGN KEY(WRITER) REFERENCES MEMBER(ID) ON DELETE CASCADE
);

ALTER TABLE INQUIRY ADD CONSTRAINT PK_INQUIRY PRIMARY KEY(INO);

CREATE SEQUENCE SEQ_INQUIRY_INO;

INSERT INTO INQUIRY VALUES (SEQ_INQUIRY_INO.NEXTVAL,'USER1','버스 안에서 너무 심심해요','좌석마다 TV좀 달아주세요','버스이용',SYSDATE);

INSERT INTO INQUIRY VALUES (SEQ_INQUIRY_INO.NEXTVAL,'USER2','버스에서 와이파이가 터졌으면 좋겠습니다.','와이파이가 안터져서 데이터요금이 많이나와요. 버스마다 공용와이파이 하나 설치 부탁드려요','건의사항',TO_DATE('20231128111111','YYYYMMDDHH24MISS'));

INSERT INTO INQUIRY VALUES (SEQ_INQUIRY_INO.NEXTVAL,'USER3','버스배차간격이 너무 큰거 같아요','이용객은 많은데 버스는 왜 1시간 간격으로 있는건가요? 추가해주셨으면 좋겠습니다.','건의사항',TO_DATE('20231128111112','YYYYMMDDHH24MISS'));




CREATE TABLE ANSWER(
    ANO NUMBER NOT NULL,    --게시물 번호
    INO NUMBER NOT NULL,                --문의게시글 번호
    WRITER VARCHAR2 (30) NOT NULL,      --작성자
    CONTENT VARCHAR2 (4000) NOT NULL,   --내용
    REGDATE DATE DEFAULT SYSDATE,       --작성일자
    FOREIGN KEY(WRITER) REFERENCES MEMBER(ID) ON DELETE CASCADE,
    FOREIGN KEY(INO) REFERENCES INQUIRY(INO) ON DELETE CASCADE
);

ALTER TABLE ANSWER ADD CONSTRAINT PK_ANSWER PRIMARY KEY(ANO);


CREATE SEQUENCE SEQ_ANSWER_ANO;

INSERT INTO ANSWER VALUES (SEQ_ANSWER_ANO.NEXTVAL,1,'GILDONG','TV는 못달아줘요',SYSDATE);

INSERT INTO ANSWER VALUES (SEQ_ANSWER_ANO.NEXTVAL,2,'GILDONG','와이파이는 이미 설치되어있습니다. 질문은 한번만 부탁드립니다.',TO_DATE('20231128111216','YYYYMMDDHH24MISS'));

INSERT INTO ANSWER VALUES (SEQ_ANSWER_ANO.NEXTVAL,3,'GILDONG','이용에 불편을 드려 죄송합니다. 해당 내용은 확인한 내용이며, 1개월 이내로 해당 노선에 대한 배차가 추가될 예정입니다. 감사합니다.',SYSDATE);



CREATE TABLE NOTICE_ATTACH(
    UUID VARCHAR2(100) NOT NULL,        --일련번호
    FILENAME VARCHAR2(100) NOT NULL,    --파일명
    UPLOADPATH VARCHAR2(200) NOT NULL,  --업로드 경로
    FILETYPE CHAR(1) DEFAULT 'I',       --파일 타입
    NNO NUMBER,
    CONSTRAINT FK_NOTICE_ATTACH_NNO FOREIGN KEY(NNO) REFERENCES NOTICE(NNO) ON DELETE CASCADE
);



COMMIT;

--SELECT * FROM MEMBER;
--SELECT * FROM SCHEDULE;
--SELECT * FROM TICKET;
--SELECT * FROM NOTICE;
--SELECT * FROM FAQ;
--SELECT * FROM INQUIRY;
--SELECT * FROM ANSWER;
--SELECT * FROM NOTICE_ATTACH;